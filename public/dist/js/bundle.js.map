{"version":3,"sources":["app.js","filter.js","timeFilter.js","album/albumController.js","album/albumService.js","artist/artistController.js","artist/artistService.js","library/libraryCtrl.js","library/libraryService.js","login/authController.js","login/loginController.js","login/loginService.js","navbar/navbar.js","recommendations/animations.js","recommendations/recommendationController.js","recommendations/service.js","search/searchController.js","search/searchService.js"],"names":["angular","module","config","$stateProvider","$urlRouterProvider","state","url","templateUrl","controller","otherwise","$cookiesProvider","defaults","path","filter","$sce","val","trustAsResourceUrl","s","ms","secs","mins","hrs","$scope","$stateParams","albumService","spotifyService","albumId","id","getAlbum","getAlbumInfo","then","response","albumInfo","saveSong","saveTrack","removeSong","removeTrack","saveAlbum","removeAlbum","service","$http","$q","loginService","token","getToken","defer","headers","method","res","artist","data","artists","image","images","name","releaseDate","release_date","tracks","items","result","alreadySaved","x","length","checkIfTrackSaved","resolve","console","log","promise","index","track","artistService","artistId","getArtistInfo","artistInfo","follow","followArtist","unfollow","unfollowArtist","undefined","artistID","genres","popularity","i","height","width","alreadyFollowing","topTracks","forEach","checkIfSongSaved","r","albumArr","album_type","push","albums","getTracksOnAlbum","trackList","libraryService","library","offset","getLib","getLibrary","item","$cookies","window","location","hash","substr","elems","split","setToken","setTimeout","redirect_uri","authorize","resp","client_id","isLoggedIn","encodeURIComponent","now","Date","time","getTime","setTime","put","get","directive","restrict","getRecommendations","getRecs","artistName","songName","genreName","recs","recommendations","song","genre","songInfo","deferred","search","songRes","artistRes","recommendationsWithInfo","recArray","rec","info","searchTerm","type","encodeURI","uri","shorten","album","albumImg","preview","preview_url","getInfo","acoutsticness","danceability","energy","instrumentalness","key","tempo","checkIfAlreadySaved","songID","acousticness","str","arr","join","searchService","hideLabels","term","searchRes","y","d","l","a","checkSong"],"mappings":"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","file":"bundle.js","sourcesContent":["angular.module('spotifyApp', ['ngCookies', 'ui.router'])\n    .config(function($stateProvider, $urlRouterProvider) {\n\n        //search state\n        $stateProvider.state('recommendations', {\n                url: '/recommendations',\n                templateUrl: '/components/recommendations/recommendTmpl.html',\n                controller: 'recommendationController'\n            })\n            //login state\n            .state('login', {\n                url: '/',\n                templateUrl: '/components/login/login.html',\n                controller: 'loginController'\n            })\n\n            .state('artist', {\n                url:'/artist/:id',\n                templateUrl: '/components/artist/artistTmpl.html',\n                controller: 'artistController'\n            })\n\n            .state('album', {\n                url:'/album/:id',\n                templateUrl: '/components/album/albumTmpl.html',\n                controller:'albumController'\n            })\n\n            .state('search', {\n                url:'/search',\n                templateUrl: '/components/search/searchTmpl.html',\n                controller: 'searchController'\n            })\n\n            .state('library', {\n                url:'/library',\n                templateUrl:'/components/library/libraryTmpl.html',\n                controller:'libraryController'\n            });\n\n        $urlRouterProvider.otherwise('/');\n\n    }).config(['$cookiesProvider', function($cookiesProvider) {\n        //makes token accessible for the whole app\n        $cookiesProvider.defaults.path = '/';\n    }]);\n","//filter to make iframes work with dynamic urls (for the spotify web player)\n//and for some images\nangular.module('spotifyApp').filter('trustAsResourceUrl', ['$sce', function($sce) {\n    return function(val) {\n        return $sce.trustAsResourceUrl(val);\n    };\n}]);\n","angular.module('spotifyApp').filter('timeFilter',function(){\n\n    return function (s) {\n        var ms = s % 1000;\n        s = (s - ms) / 1000;\n        var secs = s % 60;\n        s = (s - secs) / 60;\n        var mins = s % 60;\n        var hrs = (s - mins) / 60;\n        if(secs < 10){\n          secs = secs + '0';\n        }\n        return mins + ':' + secs;\n    };\n});\n","angular.module('spotifyApp').controller('albumController', function($scope, $stateParams, albumService, spotifyService) {\n    $scope.albumId = $stateParams.id;\n    $scope.getAlbum = function() {\n        albumService.getAlbumInfo($scope.albumId).then(function(response) {\n            $scope.albumInfo = response;\n        });\n    };\n\n    $scope.saveSong = function(id) {\n        spotifyService.saveTrack(id);\n    };\n\n    $scope.removeSong = function(id) {\n        spotifyService.removeTrack(id);\n    };\n\n    $scope.saveAlbum = function(id) {\n        spotifyService.saveAlbum(id);\n    };\n\n    $scope.removeAlbum = function(id) {\n        spotifyService.removeAlbum(id);\n    };\n    $scope.getAlbum();\n\n\n});\n","angular.module('spotifyApp').service('albumService', function($http, $q, loginService) {\n    var token = loginService.getToken();\n    var albumInfo = {};\n\n    this.getAlbumInfo = function(id) {\n        //gets basic album info\n        var defer = $q.defer();\n\n        $http({\n            headers: {\n                \"Authorization\": 'Bearer ' + token\n            },\n            method: 'GET',\n            url: 'https://api.spotify.com/v1/albums/' + id\n        }).then(function(res) {\n            albumInfo.artist = res.data.artists[0];\n            albumInfo.image = res.data.images[0].url;\n            albumInfo.name = res.data.name;\n            albumInfo.releaseDate = res.data.release_date;\n            albumInfo.tracks = res.data.tracks.items;\n        }).then(function() {\n            //checks if album has been saved\n            $http({\n                headers: {\n                    \"Authorization\": 'Bearer ' + token\n                },\n                method: 'GET',\n                url: 'https://api.spotify.com/v1/me/albums/contains?ids=' + id\n            }).then(function(result) {\n                //checks if each song has been saved\n                albumInfo.alreadySaved = result.data[0];\n                for (var x = 0; x < albumInfo.tracks.length; x++) {\n                    checkIfTrackSaved(albumInfo.tracks[x].id, x);\n                }\n            });\n        });\n        defer.resolve(albumInfo);\n        console.log(albumInfo);\n        return defer.promise;\n    };\n\n    //checks if track with given id has ben saved\n    var checkIfTrackSaved = function(id, index) {\n        var track = id;\n        $http({\n            headers: {\n                \"Authorization\": 'Bearer ' + token\n            },\n            method: 'GET',\n            url: 'https://api.spotify.com/v1/me/tracks/contains?ids=' + track\n        }).then(function(result) {\n            albumInfo.tracks[index].alreadySaved = result.data[0];\n        });\n    };\n});\n","angular.module('spotifyApp').controller('artistController', function($scope, $stateParams, artistService, spotifyService) {\n    $scope.artistId = $stateParams.id;\n    console.log($scope.artistId);\n    //gets artist info\n    artistService.getArtistInfo($scope.artistId).then(function(result) {\n        $scope.artistInfo = result;\n        console.log($scope.artistInfo);\n    });\n\n    //follows artist\n    $scope.follow = function() {\n        artistService.followArtist($scope.artistId);\n    };\n\n\n    //unfollows artist\n    $scope.unfollow = function() {\n        artistService.unfollowArtist($scope.artistId);\n    };\n\n    //saves song to user's library\n    $scope.saveSong = function(id) {\n        spotifyService.saveTrack(id);\n    };\n\n    //removes saved song from user's library\n    $scope.removeSong = function(id) {\n        spotifyService.removeTrack(id);\n    };\n\n});\n","angular.module('spotifyApp').service('artistService', function($http, $q, loginService) {\n    var token = loginService.getToken();\n    var artistInfo = {};\n    //gets artist info from spotify\n    this.getArtistInfo = function(id) {\n        //gets basic artist info\n        artistInfo.image = undefined;\n        var defer = $q.defer();\n        var artistID = id;\n        $http({\n            headers: {\n                \"Authorization\": 'Bearer ' + token\n            },\n            method: 'GET',\n            url: 'https://api.spotify.com/v1/artists/' + id\n        }).then(function(result) {\n            artistInfo.genres = result.data.genres;\n            artistInfo.popularity = result.data.popularity;\n            artistInfo.name = result.data.name;\n            //gets biggest square image\n            for (var i = result.data.images.length - 1; i >= 0; i--) {\n                if (result.data.images[i].height === result.data.images[i].width) {\n                    artistInfo.image = result.data.images[i];\n                }\n            }\n        }).then(function() {\n            //gets if a user follows an artist\n            $http({\n                headers: {\n                    \"Authorization\": 'Bearer ' + token\n                },\n                method: 'GET',\n                url: 'https://api.spotify.com/v1/me/following/contains?type=artist&ids=' + artistID\n            }).then(function(res) {\n                artistInfo.alreadyFollowing = res.data[0];\n            }).then(function() {\n                //gets an artist's top tracks\n                $http({\n                    headers: {\n                        \"Authorization\": 'Bearer ' + token\n                    },\n                    method: 'GET',\n                    url: 'https://api.spotify.com/v1/artists/' + artistID + '/top-tracks?country=US'\n                }).then(function(response) {\n                    artistInfo.topTracks = response.data.tracks;\n                    artistInfo.topTracks.forEach(function(track) {\n                        //checks if a user already\n                        checkIfSongSaved(track.id).then(function(result) {\n                            track.alreadySaved = result.data[0];\n                        });\n                    });\n                }).then(function() {\n                    //gets an artist's albums\n                    $http({\n                        headers: {\n                            \"Authorization\": 'Bearer ' + token\n                        },\n                        method: 'GET',\n                        url: 'https://api.spotify.com/v1/artists/' + artistID + '/albums?country=US'\n                    }).then(function(r) {\n                        // console.log(r);\n                        var albumArr = [];\n                        //filters out singles and compilations\n                        for (var i = 0; i < r.data.items.length; i++) {\n                            if (r.data.items[i].album_type === 'album') {\n                                albumArr.push(r.data.items[i]);\n                            }\n                        }\n                        artistInfo.albums = albumArr;\n                        console.log(artistInfo.albums);\n                        //request to get all tracks from each album\n                        for (var x = 0; x < artistInfo.albums.length; x++) {\n                            getTracksOnAlbum(artistInfo.albums[x].id, x);\n                        }\n\n                        //if there were no sqaure images from the artist\n                        //profile, it sets the artists most recent album as\n                        //the profile photo.\n                        if (!artistInfo.image) {\n                            artistInfo.image = r.data.items[0].images[0];\n                        }\n                    });\n                });\n            });\n        });\n        defer.resolve(artistInfo);\n        // console.log(artistInfo);\n        return defer.promise;\n    };\n\n    //follows artist with given id\n    this.followArtist = function(id) {\n        var artistID = id;\n        $http({\n            headers: {\n                \"Authorization\": 'Bearer ' + token\n            },\n            method: 'PUT',\n            url: 'https://api.spotify.com/v1/me/following?type=artist&ids=' + artistID\n        }).then(function(res) {\n            console.log(res);\n        });\n    };\n\n    //unfollows artist with given id\n    this.unfollowArtist = function(id) {\n        var artistID = id;\n        // console.log(`artistID ${artistID}`);\n        $http({\n            headers: {\n                \"Authorization\": 'Bearer ' + token\n            },\n            method: 'DELETE',\n            url: 'https://api.spotify.com/v1/me/following?type=artist&ids=' + artistID\n        }).then(function(res) {\n            //console.log(res);\n        });\n    };\n\n    //checks if a song is already saved to a user's library\n    var checkIfSongSaved = function(id) {\n        var artistID = id;\n        return $http({\n            headers: {\n                \"Authorization\": 'Bearer ' + token\n            },\n            method: 'GET',\n            url: 'https://api.spotify.com/v1/me/tracks/contains?ids=' + artistID\n        });\n    };\n\n    //gets tracks on album with given id, made it a separate\n    //function to break scope\n    var getTracksOnAlbum = function(id, index) {\n        var artistID = id;\n        $http({\n            headers: {\n                \"Authorization\": 'Bearer ' + token\n            },\n            method: 'GET',\n            url: 'https://api.spotify.com/v1/albums/' + artistID\n        }).then(function(trackList) {\n            artistInfo.albums[index].tracks = trackList.data.tracks;\n        });\n    };\n\n});\n","angular.module('spotifyApp').controller('libraryController', function($scope, libraryService){\n    $scope.library = {};\n    $scope.library.items = [];\n    $scope.offset = 0;\n\n    $scope.getLib = function(){\n      libraryService.getLibrary($scope.offset).then(function(result){\n        result.data.items.forEach(function(item){\n          $scope.library.items.push(item);\n        });\n      });\n      $scope.offset += 20;\n    };\n    $scope.getLib();\n});\n","angular.module('spotifyApp').service('libraryService', function($http, spotifyService, loginService){\n  var token = loginService.getToken();\n\n  this.getLibrary = function(offset){\n    return $http({\n      headers: {\n          \"Authorization\": 'Bearer ' + token\n      },\n      method: 'GET',\n      url: 'https://api.spotify.com/v1/me/tracks?offset=' + offset\n    });\n  };\n});\n","angular.module('spotifyApp').controller('authController', function($scope, loginService, $cookies) {\n\n    //method to extract token from redirect url\n    $scope.getToken = function() {\n        var url = window.location.hash.substr(1);\n        var elems = url.split('=');\n        console.log(elems);\n        console.log(elems[1].split('&'));\n        $scope.token = (elems[1]);\n    };\n\n    //gets token from url\n    $scope.getToken();\n\n    //sets token\n    loginService.setToken($scope.token);\n\n    //redirects home after 1s\n    setTimeout(function() {\n        window.location = 'http://localhost:8080/#/search';\n    }, 1000);\n\n});\n","angular.module('spotifyApp').controller('loginController', function($scope, loginService) {\n    var redirect_uri = 'http://localhost:8080/components/login/afterAuth.html';\n    //redirects to spotify permission request\n    $scope.authorize = function() {\n        loginService.authorize().then(function(resp) {\n            window.location = \"https://accounts.spotify.com/authorize?client_id=\" + client_id + \"&redirect_uri=\" + redirect_uri + \"&scope=user-library-modify%20user-top-read%20user-library-read%20user-follow-modify%20user-follow-read&response_type=token\";\n        });\n    };\n    loginService.getToken();\n    $scope.isLoggedIn = loginService.isLoggedIn;\n    if($scope.isLoggedIn){\n      window.location = \"http://localhost:8080/#/recommendations\";\n    }\n});\n","var client_id = '9307698323d44b158135c48936a25dbf';\nvar redirect_uri = encodeURIComponent('http://localhost:8080/components/login/afterAuth.html');\n\nangular.module('spotifyApp').service('loginService', function($cookies, $http) {\n    this.isLoggedIn = false;\n    //requests auth token from spotify\n    this.authorize = function() {\n        return $http({\n            method: 'GET',\n            url: \"https://accounts.spotify.com/authorize?client_id=\" + client_id + \"&redirect_uri=\" + redirect_uri + \"&scope=user-library-modify%20user-top-read%20user-library-read%20user-follow-modify%20user-follow-read&response_type=token\"\n        });\n    };\n\n    //save token to a cookie that expires in 1hr\n    this.setToken = function(token){\n      var now = new Date();\n      var time = now.getTime();\n      time += 3600 * 1000;\n      now.setTime(time);\n      $cookies.put('token', token, {'expires': now});\n      console.log(token);\n      this.token = token;\n      this.isLoggedIn = true;\n    };\n\n    //gets token from a cookie\n    this.getToken = function() {\n        var token = $cookies.get('token');\n        console.log(token);\n        if(token){\n          this.isLoggedIn = true;\n        }else{\n          this.isLoggedIn = false;\n        }\n        return token;\n    };\n});\n","angular.module('spotifyApp').directive('navBar', function(){\n  return {\n    restrict:'E',\n    templateUrl:'/components/navbar/navbarTmpl.html'\n  };\n});\n","","var client_id = '9307698323d44b158135c48936a25dbf';\nvar redirect_uri = encodeURIComponent('http://localhost:8080/afterAuth.html');\n\nangular.module('spotifyApp').controller('recommendationController', function($scope, spotifyService, loginService) {\n\n    //gets token from saved coookie\n    $scope.getToken = function() {\n        $scope.token = loginService.getToken();\n\n        //redirects if user not logged in\n        if(!$scope.token){\n          window.location='/';\n        }\n    };\n\n    //gets saved token when page is loaded\n    $scope.getToken();\n\n    //gets recommendations based on seeds\n    $scope.getRecommendations = function() {\n        spotifyService.getRecs($scope.artistName, $scope.songName, $scope.genreName).then(function(recs) {\n            console.log(recs);\n            $scope.recommendations = recs.data;\n        });\n    };\n\n    //saves song to user's library\n    $scope.saveSong = function(id) {\n        spotifyService.saveTrack(id);\n    };\n\n    //removes song from user's library\n    $scope.removeSong = function(id){\n      spotifyService.removeTrack(id);\n    };\n});\n","var client_id = '9307698323d44b158135c48936a25dbf';\nvar redirect_uri = encodeURIComponent('http://localhost:8080/afterAuth.html');\n\nangular.module('spotifyApp').service('spotifyService', function($http, $q, $cookies, loginService) {\n    //looks up ids of provided elements and\n    //gets recommendations accordingly\n    var token;\n    this.getRecs = function(artist, song, genre) {\n        token = loginService.getToken();\n        console.log(artist + \" \" + song + \" \" + genre);\n        var songInfo;\n        var artistInfo;\n        var deferred = $q.defer();\n\n        //gets track ID and info\n        search(song, \"track\").then(function(songRes) {\n            console.log(songRes);\n            songInfo = songRes;\n            //gets artist ID and info\n            search(artist, \"artist\").then(function(artistRes) {\n                console.log(artistRes);\n                artistInfo = artistRes;\n                //gets recommendations\n                $http({\n                    headers: {\n                        \"Authorization\": 'Bearer ' + token\n                    },\n                    method: 'GET',\n                    url: 'https://api.spotify.com/v1/recommendations?seed_tracks=' + songInfo.id + '&seed_artists=' + artistInfo.id + '&seed_genres=' + genre\n                }).then(function(response) {\n                    var recommendationsWithInfo = {};\n                    console.log(response);\n                    //array of recommendations with info about each one\n                    var recArray = [];\n                    var recommendations = response.data.tracks;\n                    recommendations.forEach(function(rec) {\n                        var name = rec.name;\n                        search(name, \"track\").then(function(info) {\n                            recArray.push(info);\n                        });\n                    });\n                    recommendationsWithInfo.data = recArray;\n                    deferred.resolve(recommendationsWithInfo);\n                });\n            });\n        });\n        return deferred.promise;\n    };\n\n    //gets a provided song/artists id, name,\n    //popularity and an assosciated image\n    var search = function(searchTerm, type) {\n        var defer = $q.defer();\n\n        $http({\n            method: 'GET',\n            url: 'https://api.spotify.com/v1/search?q=' + encodeURI(searchTerm) + \"&type=\" + type\n        }).then(function(result) {\n            // console.log(result);\n\n            var info = {\n                id: result.data[type + 's'].items[0].id,\n                uri: \"https://embed.spotify.com/?uri=\" + result.data[type + 's'].items[0].uri,\n                popularity: result.data[type + 's'].items[0].popularity,\n            };\n            if (result.data[type + 's'].items[0].name.length > 22) {\n                info.name = shorten(result.data[type + 's'].items[0].name);\n            } else {\n                info.name = result.data[type + 's'].items[0].name;\n            }\n            if (type === 'artist') {\n                info.image = result.data.artists.items[0].images[0].url;\n            } else {\n                info.albumId = result.data.tracks.items[0].album.id;\n                info.albumImg = result.data.tracks.items[0].album.images[0].url;\n                info.preview = result.data.tracks.items[0].preview_url;\n                info.artistInfo = {\n                    name: result.data.tracks.items[0].artists[0].name,\n                    id: result.data.tracks.items[0].artists[0].id\n                };\n                //get specific stats about each song.\n                getInfo(info.id).then(function(result) {\n                    info.acoutsticness = result.acoutsticness;\n                    info.danceability = result.danceability;\n                    info.energy = result.energy;\n                    info.instrumentalness = result.instrumentalness;\n                    info.key = result.key;\n                    info.tempo = result.tempo;\n                }).then(function(result){\n                  checkIfAlreadySaved(info.id).then(function(result){\n                      info.alreadySaved = result;\n                      console.log(info.alreadySaved);\n                  });\n                });\n            }\n            defer.resolve(info);\n        });\n        return defer.promise;\n    };\n\n\n    //gets detailed statistics about and individual song\n    var getInfo = function(songID) {\n        var defer = $q.defer();\n        $http({\n            headers: {\n                'Accept': 'application/json',\n                'Authorization': 'Bearer ' + token\n            },\n            method: 'GET',\n            url: 'https://api.spotify.com/v1/audio-features/' + songID\n        }).then(function(res) {\n            defer.resolve({\n                acousticness: res.data.acousticness,\n                danceability: res.data.danceability,\n                energy: res.data.energy,\n                instrumentalness: res.data.instrumentalness,\n                key: res.data.key,\n                tempo: res.data.tempo\n            });\n        });\n        return defer.promise;\n    };\n\n    //saves track to your library\n    this.saveTrack = function(id) {\n      token = loginService.getToken();\n      var defer = $q.defer();\n\n      $http({\n            headers: {\n                'Authorization': 'Bearer ' + token\n            },\n            method: 'PUT',\n            url: 'https://api.spotify.com/v1/me/tracks?ids=' + id\n      }).then(function(result){\n        console.log(result.data);\n      });\n    };\n\n    this.removeTrack = function(id){\n      token = loginService.getToken();\n      $http({\n        headers: {\n          'Authorization' : 'Bearer ' + token\n        },\n        method: 'DELETE',\n        url: 'https://api.spotify.com/v1/me/tracks?ids=' + id\n      }).then(function(result){\n        console.log(result.data);\n      });\n    };\n\n    this.saveAlbum = function(id){\n      token = loginService.getToken();\n      $http({\n        headers: {\n          'Authorization' : 'Bearer ' + token\n        },\n        method: 'PUT',\n        url: 'https://api.spotify.com/v1/me/albums?ids=' + id\n      }).then(function(result){\n        console.log(result.data);\n      });\n    };\n\n    this.removeAlbum = function(id){\n      token = loginService.getToken();\n      $http({\n        headers: {\n          'Authorization' : 'Bearer ' + token\n        },\n        method: 'DELETE',\n        url: 'https://api.spotify.com/v1/me/albums?ids=' + id\n      }).then(function(result){\n        console.log(result.data);\n      });\n    };\n\n    //checks if song is already saved to user's library\n    var checkIfAlreadySaved = function(id){\n        var defer = $q.defer();\n        $http({\n          headers: {\n            'Authorization' : 'Bearer ' + token\n          },\n          method: 'GET',\n          url:'https://api.spotify.com/v1/me/tracks/contains?ids=' + id\n        }).then(function(result){\n          defer.resolve(result.data[0]);\n        });\n        return defer.promise;\n    };\n\n\n\n    //shortesn song titles that are too long\n    this.shorten = function(str) {\n        var arr = str.split(\"\");\n        var res = [];\n        for (var i = 0; i < 22; i++) {\n            res.push(arr[i]);\n        }\n        res.push('...');\n        return res.join('');\n    };\n\n    var shorten = this.shorten;\n});\n","angular.module('spotifyApp').controller('searchController', function($scope, searchService, spotifyService){\n    $scope.hideLabels = true;\n    $scope.search = function(term){\n      searchService.search(term).then(function(result){\n        console.log(result);\n        $scope.hideLabels = false;\n        $scope.result = result;\n        console.log($scope.result);\n      });\n    };\n\n    $scope.removeSong = function(id){\n      spotifyService.removeTrack(id);\n    };\n\n    $scope.saveSong = function(id){\n      spotifyService.saveTrack(id);\n    };\n});\n","angular.module('spotifyApp').service('searchService', function($http, $q, spotifyService, loginService){\n  var searchRes = {};\n  var token = loginService.getToken();\n  this.search = function(term){\n    var defer = $q.defer();\n    $http({\n      method: 'GET',\n      url:'https://api.spotify.com/v1/search?q=' + term + '&type=artist,album,track'\n    }).then(function(result){\n      searchRes.tracks = result.data.tracks;\n      searchRes.albums = [];\n      searchRes.artists = [];\n\n      //checks that artist has a photo\n      for(var i = 0; i < result.data.artists.items.length; i++){\n        if(result.data.artists.items[i].images.length > 0){\n          searchRes.artists.push(result.data.artists.items[i]);\n        }\n      }\n\n      //checks artist name length\n      for(var x = 0; x < searchRes.artists.length; x++){\n        if(searchRes.artists[x].name.length > 20){\n          searchRes.artists[x].name = spotifyService.shorten(searchRes.artists[x].name);\n        }\n      }\n\n      //checks all albums have a photo\n      for(var y = 0; y < result.data.albums.items.length; y++){\n        if(result.data.albums.items[y].images.length > 0){\n          searchRes.albums.push(result.data.albums.items[y]);\n        }\n      }\n\n      //checks album name length\n      for(var d = 0; d < searchRes.albums.length; d++){\n        if(searchRes.albums[d].name.length > 18){\n          searchRes.albums[d].name = spotifyService.shorten(searchRes.albums[d].name);\n        }\n      }\n\n      //checks songs album name length\n      for(var l = 0; l < searchRes.tracks.items.length; l++){\n        if(searchRes.tracks.items[l].album.name.length > 18){\n          searchRes.tracks.items[l].album.name = spotifyService.shorten(searchRes.tracks.items[l].album.name);\n        }\n      }\n\n      //checks if song is saved\n      for (var a = 0; a < searchRes.tracks.items.length; a++) {\n          checkSong(searchRes.tracks.items[a].id, a);\n      }\n\n    });\n\n    defer.resolve(searchRes);\n    return defer.promise;\n  };\n\n  var checkSong = function(id, index) {\n      $http({\n          headers: {\n              \"Authorization\": 'Bearer ' + token\n          },\n          method: 'GET',\n          url: 'https://api.spotify.com/v1/me/tracks/contains?ids=' + id\n      }).then(function(res){\n          searchRes.tracks.items[index].alreadySaved = res.data[0];\n      });\n  };\n\n});\n"]}